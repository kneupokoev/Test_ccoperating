# Frontend_История операций по карте
**Цель:** документ описывает раздел «История операций», и дополнительные формы, входящие в раздел.
## История изменений
Автор | Дата изменения | Версия изменений | Описание | Задача |
------------- | ------------- | ------------- | ------------- | -------------
Ёлкина В.А.|17.04.2022 |1.0|Исходная версия документа|TASK-1
## Ссылка на дизайн
tbd
## Общие требования к разделу
Раздел доступен всем клиентам ДБО. Раздел после нажатия на кнопку «Показать историю операций» в разделе «Список карт»
### Макет раздела

![](DocsFiles/1.jpg)
![](DocsFiles/2.jpg)

На экранную форму необходимо добавить кнопку «Отобразить полную историю операций» с кнопкой «Выбрать период», чтобы отобразить историю операций за определенный период период.
## Блок «История операций»
Для отображения раздела Frontend инициирует вызов сервиса GET api/cards/{cardId}/transactions.
В случае если от сервиса получена ошибка или пустой ответ, отображается экран с ошибкой. Текст сообщения «Отсутствуют операции по карте»
В случае если получен успешный ответ, Frontend отображает форму с параметрами:

Поле | Описание
------------- | -------------
История операций	| Содержит экземпляры data/cards/{cardId}/transactions ответа сервиса GET api/cards/{cardId}/transactions
Элемент Операция |
Иконка	 | Значение data/cards/{cardId}/transactions/transactionDesign Если значение не получено, отображается иконка по-умолчанию
Дата и время совершения операции	| Значение data/cards/{cardId}/transactions/dateTime
Название операции	| Значение data/cards/{cardId}/transactions/name
Сумма операции	| Значение data/cards/{cardId}/transactions/amount
Валюта операции	| Значение data/cards/{cardId}/transactions/currency
Категория операции	| Значение data/cards/{cardId}/transactions/category
По умолчанию отображается краткая история операций за последние 10 дней, но не более 5 операций.
По кнопке «Отобразить полную историю операций» отображется история операций за последний месяц. По кнопке «Выбрать период» отображается окно ввода дат, за период между которыми нужно отобразить историю операций.
# API_Получение истории операций по карте
## История изменений
Автор | Версия изменений | Описание | Задача |
------------- | ------------- | ------------- | -------------
Ёлкина В.А.|1.0|Исходная версия документа|TASK-1
**Цель:** сервис предназначен для получения истории операций по карте клиента.
**URL:** [endpoint]/api/cards/{cardId}/transactions
**Метод:** GET
**Доступ:** авторизованная зона. Сервис вызывается с фронта.
**Входные параметры:**
Параметр	| Тип поля	| Описание	| Обязательность
------------- | ------------- | ------------- | -------------
cardId	| string	| Id карты, по которой нужно получить историю операций	| Да
dateStart	| date	| Дата начала периода, за который нужно отобразить операции	| Нет
dateEnd	| date	| Дата окончания периода, за который нужно отобразить операции	| Нет
**Выходные параметры:**
Параметр	| Тип поля	| Описание	| Обязательность
------------- | ------------- | ------------- | -------------
data/cards/{cardId}/transactions | List[Object]	| Список операций по карте	| Нет
data/cards/{cardId}/transactions/iconDesign	| String	| Дизайн карты (урл до картинки)	| Нет
data/cards/{cardId}/transactions/dateTime	| DateTime	| Дата и время совершения операции	| Да
data/cards/{cardId}/transactions/name	| String	| Название операции	| Да
data/cards/{cardId}/transactions/amount	| Decimal	| Сумма операции	| Да
data/cards/{cardId}/transactions/currency	| String	| Валюта операции	| Да
data/cards/{cardId}/transactions/category	| String| Категория операции | Да
## Основной сценарий (MC)
1.	На сервис поступают входные параметры cardID/
2.	Сервис выполняет поиск операций по карте.
	  1.	Если операций по карте не найдено, то ЕС-1. По карте нет операций
	  2.	Иначе сценарий продолжается.
3.	Сервис отбирает операции по карте:
	  1.	Если входные параметры dateStart и dateEnd отсутствуют, то сервис отбирает 5 последних операций за последние 10 дней.
	  2.	Если входные параметры dateStart и dateEnd заполнены, то сервис отображает все операции за выбранный период
4.	Сервис формирует ответ согласно маппингу:

Параметр ответа	| Правило формирования
------------- | -------------
data/cards/{cardId}/transactions | -
data/cards/{cardId}/transactions/iconDesign	| Значение transaction.transaction_design
data/cards/{cardId}/transactions/dateTime	| Значение transaction.transaction_date
data/cards/{cardId}/transactions/name	| Значение  transaction.
data/cards/{cardId}/transactions/amount	| Значение  transaction.auth_amount
data/cards/{cardId}/transactions/currency	| Значение  transaction.auth_currency
data/cards/{cardId}/transactions/category	| Значение  transaction.oper_type

5.	Сервис возвращает ответ вызывающей системе.
## Исключительные сценарии (EC)
**ЕС-1. По карте нет операций**

1.	Сервис формирует ответ, согласно маппингу.

Параметр ответа	| Правило формирования
------------- | -------------
data/error/code	| Код ошибки
data/error/text	| “transaction.transaction”

2.	API возвращает ответ.

**Конфигурационные параметры**
Название конфига	| Значение	| Описание
------------- | ------------- | -------------	 	 
| | 