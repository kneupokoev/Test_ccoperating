# Frontend_Список карт и детали по карте
Цель: документ описывает раздел "Список карт", и дополнительные формы, входящие в раздел.
## История изменений
| Автор         | Дата изменения | Версия изменений |Описание| Задача     |
|---------------|----------------|------------------|--------|------------|
| Малышева Н.С. | 15.09.2021     | 1.0              | Исходная версия документа | TASK-1     |
| Штокин В.Д.   | 20.04.2022     | 1.0              | Добавление "История операций"| AN_DOC_1   |
## Ссылка на дизайн
TBD
## Общие требования к разделу
Раздел доступен всем клиентам ДБО. Раздел открывается сразу после входа в ДБО и является частью "Главного экрана".
### Макет раздела
![](attach/image4.jpg)
![](attach/image2.jpg)
![](attach/image3.jpg)

## Блок карты
Для отображения раздела Frontend инициирует вызов сервиса GET api/cards/list (запрос не параметризован)  

В случае, если от сервиса получена ошибка или пустой ответ, отображается экран с ошибкой. Текст сообщения: "Что-то пошло не так, но мы уже знаем о проблеме..."

В случае если получен успешный ответ, Frontend отображает форму с параметрами:

| Поле	             | 	Описание                                                                                                                                                                                                                          |
|-------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Блок с картами	   | 	Содержит экземпляры data/cards[] ответа сервиса GET api/cards/list                                                                                                                                                                |
| Элемент Карта     |                                                                                                                                                                                                                                    |
| Иконка            | Значение data/cards/cardDesign<br/>Если значение не получено, отображается иконка по-умолчанию                                                                                                                                     |                                                                    |                                                                     |
| Название карты    | Значение data/cards/name<br/>В поле отображается 100 символов. Если значение больше, то отображается только часть текста в троеточие.<br/>При наведении на такую строку полный текст должен отображаться во всплывающей подсказке. |
 | Платежная система | Значение data/cards/paySystem                                                                                                                                                                                                      |
 | Номер карты       | Значение data/cards/maskedNumber<br/>Отображается в формате *ХХХХ, где ХХХХ - последние 4 цифры значения                                                                                                                           |
 | Тип карты         | Значение data/cards/cardType<br/>В случае если получено значение:<br/>'debit' отобразить текст "Дебетовая"<br/>'credit' отобразить текст "Кредитная"                                                                               |
| Баланс            | Значение data/cards/balance<br/>По-умолчанию отображается зеленым цветом<br/>В случае если значение отрицательное - отображается красным цветом                                                                                    |
| Статус карты      | Если получено значение data/cards/status<br/>'active' - отобразить значение "Активна"<br/>'blocked' - отобразить значение "Заблокирована"<br/>'inactive' - отобразить значение "Требует активации"                                  |
Под каждой картой отображаются действия, доступные с картой:

| Действие         | Описание                                                                                                                                                                                                            |
|------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Реквизиты        | tbd                                                                                                                                                                                                                 | 
| Тарифы           | tbd                                                                                                                                                                                                                 |
 | Заблокировать    | tbd                                                                                                                                                                                                                 | 
 | История операций | см. Раздел Итория операций<br/>Элемент представлен ссылкой.<br/>По нажатию на ссылку появляется раскрывающийся вниз блок<br/>Заголовок блока меняется в зависимости от раскрытия: "Показать/Скрыть историю операций" |

### История операций
Для отображения раздела Frontend инициирует вызов сервиса GET api/cards/transactionsHistory

В случае если от сервиса получена ошибка, отображается экран с ошибкой. Текст сообщения "Что-то пошло не так, но мы уже знаем о проблеме...". В случае если от сервиса получен пустой ответ, на экране отображается сообщение с текстом "Нет операций".

В случае если получен успешный ответ, Frontend отображает форму с параметрами:

| Поле	                               | Описание                                                                                      |
|-------------------------------------|-----------------------------------------------------------------------------------------------|
| Блок с операциями	                  | Содержит экземпляры data/cards/transactions[] ответа сервиса GET api/cards/transactionHistory |
| Элемент операция                    |                                                                                               |
| Дата и время совершения операции	   | Значение data/cards/transactions/date                                                         |
| Название операции/название мерчанта | 	Значение data/cards/transactions/name                                                        |
| Сумма операции	                     | Значение data/cards/transactions/transactionsAmount                                           |
| Валюта операции	                    | Значение data/cards/transactions/transactionCurrency                                          |
| Категория операции	                 | Значение data/cards/transactions/transactionCategory                                          |
| Иконка операции/мерчанта	           | Значение data/cards/transactions/transactionDesign                                            |

Над информацией об операциях отображаются действия доступные в этой форме:

| Действие	         | Описание                                                                                               |
|-------------------|--------------------------------------------------------------------------------------------------------|
| 	 Показать больше | Отображает все операции за последний месяц                                                             |
| Фильтр            | Отображает операции в отфильтрованном порядке по значению data/cards/transactions/transactionsCategory |
| Выбрать период    | Отображает операции в заданном порядке, опираясь на значение data/cards/transactions/date              |
 | Сортировка по сумме | Отображает отсортированные операции по значению data/cards/transactions/transactionAmount              |
| Сортировка по дате | Отображает отсортированные операции по значению data/cards/transactions/date                           |
